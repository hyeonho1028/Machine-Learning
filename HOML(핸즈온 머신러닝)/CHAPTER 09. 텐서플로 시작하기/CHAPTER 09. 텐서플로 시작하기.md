# CHAPTER 09. 텐서플로 시작하기

> TensorFlow는 수치 계산을 위한 강력한 오픈소스 소프트웨어 라이브러리로 특히 대규모 머신러닝에 맞춰 세밀하게 튜닝되어 있습니다. 기본 원리는 간단합니다. 먼저 파이썬으로 수행할 계산 그래프를 정의한 다음, 텐서플로가 최적화된 C++코드를 사용해 이 그래프를 효율적으로 실행시킵니다.



##### 텐서플로의 특징

1. 여러 CPU, GPU에서 병렬로 실행할 수 있다. 분산 컴퓨팅도 지원하므로 수백 대의 서버에 계산을 나누어 납득할만한 시간 안에 대규모 데이터셋으로 거대한 신경망을 훈련시킬 수 있다. 또한 수백만 개의 특성을 가진 수십억 개의 샘플로 구성된 데이터셋에서 수백만 개의 파라미터를 가진 네트워크를 훈련시킬 수 있다.
2. 깔끔한 설계, 확장성, 유연성과 잘 정돈된 문서가 있다.



##### 텐서플로의 주요기능

1. 윈도우, 리눅스 macOS뿐만 아니라 iOS와 안드로이드 같은 모바일 기기에서도 실행된다.
2. 사이킷런과 호환되는 매우 간결한 파이썬 API인 TF.Learn을 제공한다. 여러 종류의 신경망을 몇 줄의 코드로 훈련시킬 수 있다.
3. 신경망의 구축, 훈련, 평가를 단순화한 TF-slim이라는 간편한 API도 제공한다.
4. Keras나 Pretty Tensor와 같은 여러 가지 고수준 API가 텐서플로를 기반으로 독립적으로 구축되었다.
5. 생각하는 어떤 신경망 구조는 물론 모든 종류의 계산 그래프를 만들 수 있다.
6. 머신러닝 연산, 신경망을 만드는 데 필요한 연산을 C++로 매우 효율적으로 구현했다. C++ API도 제공하고 있기 때문에 자신만의 고성능 연산을 만들 수 있다.
7. 비용 함수를 최조화하는 모델 파라미터를 찾기 위한 여러 가지 고수준의 최적화 노드를 제공한다. 텐서플로는 우리가 정의한 함수의 그래디언트를 자동으로 계산해주기 때문에 사용하기 매우 쉽다. 이를 automatic differentiation(autodiff) 자동 미분이라고 한다.
8. TensorBoard라는 훌륭한 시각화 도구를 사용해 계산 그래프와 학습 곡선 등을 웹 브라우저로 확인할 수 있다.
9. 텐서플로의 계산 그래프를 실행할 수 있는 클라우드 서비스도 론칭하였다.
10. stackoveflow를 통한 질문 및 답변이 가능하다.



### 9.1 설치

virtualenv를 사용해 분리된 환경을 만들고 활성화 한 후 설치



### 9.2 첫 번째 계산 그래프를 만들어 세션에서 실행하기

```python
import tensorflow as tf
x = tf.Variable(3, name='x')
y = tf.Variable(4, name='y')
f = x*x*y + y + 2
```

4line에서 무언가를 계산하는 것 같아 보이지만 실제로 어떤 계산도 수행하지 않는다. 계싼 그래프만 믄들 뿐이다. 사실 변수조차도 초기화되지 않는다. 이 계산 그래프를 평가하려면 텐서플로세션을 시작하고 변수를 초기화한 다음 f를 평가해야 한다. 텐서플로 세션은 연산을 CPU나 GPU같은 장치에 올리고 실행하는 것을 도와주며 모든 변숫값을 가지고 있다. 

결국 세션을 만들고 변수를 초기화하고 f를 평가하고 세션을 닫아야한다!(자원 해제)



일반적으로 텐서플로 프로그램은 두 부분으로 나뉜다. 첫 부분은 계산 그래프를 만들고(**구성 단계**), 두 번째 부분은 이 그래프를 실행한다.(**실행 단계**) 구서단계에서는 훈련에 필요한 계산과 머신러닝 모델을 표현한 계산 그래프를 만든다. 실행 단계에서는 훈련 스텝을 반복해서 펴아하고9미니배치마다 한 스텝씩), 모델 파라미터를 점진적으로 개선하기 위해 반복 루프를 수행합니다.



### 9.3 계산 그래프 관리

> 노드를 만들면 자동으로 기본 계산 그래프에 추가됩니다.

```python
>>> x1 = tf.Variable(1)
>>> x1.graph is tf.get_default_graph()
True
```

대부분의 경우 이것으로 충분하다. 가끔은 독립적인 계산 그래프를 여러개 만들어야 할 때가 있다. 이렇게 하려면 다음과 같이 새로움 Graph 객체를 만들어 with 블록 안에서 임시로 이를 기본 계산 그래프로 사용할 수 있다.



### 9.4 노드 값의 생애주기

> 한 노드를 평가할 때 텐서플로는 이 노드가 의존하고 있는 다른 노드들을 자동으로 찾아 먼저 평가한다.



### 9.5 텐서플로를 이용한 선형 회귀

텐서플로 연산(ops)은 여러 개의 이벽을 받아 출력을 만들 수 있다.



### 9.6 경사 하강법 구현



#### 9.6.1 직접 그래디언트 계산



#### 9.6.2 자동 미분 사용





### 9.7 훈련 알고리즘에 데이터 주입



### 9.8 모델 저장과 복원



### 9.9 텐서보드로 그래프와 학습 곡선 시각화하기



### 9.10 이름 범위



### 9.11 모듈화



### 9.12 변수 공유



### 9.13 연습문제

























